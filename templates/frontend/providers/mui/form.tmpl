{{- /* Schema-Driven Form Component Template */ -}}
// ============================================================================
// AUTO-GENERATED by ANG (Architectural Normalized Generator)
// Component: {{ .Name }}Form
// Type: {{ if .IsUpdate }}Update Form (PATCH/PUT){{ else }}Create Form (POST){{ end }}
// DO NOT EDIT - changes will be overwritten on next generation
// ============================================================================

// ============================================================================
// SECTION: Imports
// PURPOSE: React Hook Form + schema-driven AutoForm renderer
// LIBRARIES:
//   - react-hook-form: Form state management and validation
//   - @/components/ui/auto-form: Runtime schema renderer
// ============================================================================
import { AutoForm } from '@/components/ui/auto-form';
import type { FormSchema } from '@/components/ui/auto-form';
import { use{{ .Name }}Form } from '../../forms';
import { use{{ .Name }} } from '../../hooks';
import type { {{ .InputType }}, {{ .ResponseType }} } from '../../types';
{{- range .CustomImports }}
import { {{ .Component }} } from '{{ .Path }}';
{{- end }}

// ============================================================================
// SECTION: Component Props
// PURPOSE: Define form component interface
// PROPS:
//   - onSuccess: Callback after successful mutation
//   - onError: Callback on mutation error
//   - onCancel: Callback for cancel button
{{- if .IsUpdate }}
//   - defaultValues: Pre-populate form fields for editing
{{- end }}
// ============================================================================
export interface {{ .Name }}FormProps {
  onSuccess?: (data: {{ .ResponseType }}) => void;
  onError?: (error: Error) => void;
  onCancel?: () => void;
{{- if .IsUpdate }}
  defaultValues?: Partial<{{ .InputType }}>;
{{- end }}
}

export const {{ .SchemaVar }}: FormSchema<{{ .InputType }}> = {
  schemaVersion: 1,
  layout: { type: 'grid', columns: 12 },
  fields: [
{{- range .Fields }}
{{ template "fieldSchema" . }}
{{- end }}
  ],
};

// ============================================================================
// SECTION: Form Component
// PURPOSE: Render form with controlled inputs and submit handling
// PATTERN: Controller pattern for react-hook-form integration
// MUTATION: use{{ .Name }} hook for API call
// ============================================================================
export function {{ .Name }}Form({ onSuccess, onError, onCancel{{- if .IsUpdate }}, defaultValues{{- end }} }: {{ .Name }}FormProps) {
  const form = use{{ .Name }}Form({{- if .IsUpdate }}{ defaultValues }{{- end }});
  const { mutate, isPending } = use{{ .Name }}({
    onSuccess: (data) => onSuccess?.(data),
    onError: (error) => onError?.(error as Error),
  });

  return (
    <AutoForm
      form={form}
      schema={{ .SchemaVar }}
      onSubmit={(data) => mutate(data)}
      isPending={isPending}
      onCancel={onCancel}
      submitLabel="{{ .SubmitLabel | default "Сохранить" }}"
      loadingLabel="{{ .SubmitLoadingLabel | default "Сохранение..." }}"
      cancelLabel="{{ .CancelLabel | default "Отмена" }}"
    />
  );
}
