// ============================================================================
// AUTO-GENERATED by ANG (Architectural Normalized Generator)
// Version: {{ ANGVersion }}
// InputHash: {{ InputHash }}
// CompilerHash: {{ CompilerHash }}
// DO NOT EDIT - changes will be overwritten on next generation
// GENERATED: true
// ============================================================================

package port

//go:generate go run go.uber.org/mock/mockgen@latest -source=$GOFILE -destination=mocks/mock_$GOFILE -package=mocks

import (
	"context"
	"log/slog"
	{{- if or (HasEventMethods .) (HasDomainTypes .) }}
	"{{GoModule}}/internal/domain"
	{{- end }}
)

{{- define "log_valuer" }}
// LogValue implements slog.LogValuer interface.
func (e {{ .Name }}) LogValue() slog.Value {
	return slog.GroupValue(
		{{- range .Fields }}
		{{- if .IsSecret }}
		slog.String("{{ JSONName .Name }}", "***"),
		{{- else if .IsPII }}
		slog.String("{{ JSONName .Name }}", "[PII]"),
		{{- else }}
		slog.Any("{{ JSONName .Name }}", e.{{ ExportName .Name }}),
		{{- end }}
		{{- end }}
	)
}
{{- end }}

{{- if .Description }}
// {{ .Name }} {{ .Description }}
{{- else }}
// {{ .Name }} defines the service interface.
{{- end }}
type {{ .Name }} interface {
{{- range .Methods }}
	{{- $event := EventForMethod $ . }}
	{{- if .Description }}
	// {{ .Name }} {{ .Description }}
	{{- end }}
	{{- if .Source }}
	// Source: {{ .Source }}
	{{- end }}
	{{- if $event }}
	{{ .Name }}(ctx context.Context, req domain.{{ ExportName $event }}) error
	{{- else }}
	{{ .Name }}(ctx context.Context, req {{ .Input.Name }}) ({{ if .Output.Name }}{{ .Output.Name }}, {{ end }}error)
	{{- end }}
{{- end }}
}

// Request/Response DTOs
{{- range .Methods }}
{{- if not (EventForMethod $ .) }}
// {{ .Input.Name }}
{{- if .Input.Source }}
// Source: {{ .Input.Source }}
{{- end }}
type {{ .Input.Name }} struct {
	{{- range .Input.Fields }}
	{{- $tag := FieldValidateTag . }}
	{{- if .Source }}
	// Source: {{ .Source }}
	{{- end }}
	{{ .Name | ExportName }} {{ .Type }} `json:"{{ JSONName .Name }}"{{ if $tag }} validate:"{{ $tag }}"{{ end }}`
	{{- end }}
}
{{ template "log_valuer" .Input }}
{{- end }}
{{- if and .Output.Name (not (EventForMethod $ .)) }}
// {{ .Output.Name }}
{{- if .Output.Source }}
// Source: {{ .Output.Source }}
{{- end }}
type {{ .Output.Name }} struct {
	{{- range .Output.Fields }}
	{{- $tag := FieldValidateTag . }}
	{{- if .Source }}
	// Source: {{ .Source }}
	{{- end }}
	{{ .Name | ExportName }} {{ .Type }} `json:"{{ JSONName .Name }}"{{ if $tag }} validate:"{{ $tag }}"{{ end }}`
	{{- end }}
}
{{ template "log_valuer" .Output }}
{{- end }}
{{- end }}

{{- range ServiceNestedTypes . }}
type {{ .Name }} struct {
	{{- range .Fields }}
	{{- $tag := FieldValidateTag . }}
	{{ .Name | ExportName }} {{ .Type }} `json:"{{ JSONName .Name }}"{{ if $tag }} validate:"{{ $tag }}"{{ end }}`
	{{- end }}
}
{{ template "log_valuer" . }}
{{- end }}
